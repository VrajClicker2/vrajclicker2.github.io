<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vraj Clicker 2 | Official</title>
    <style>
        :root {
            --bg: #05070a;
            --panel: rgba(17, 24, 39, 0.95);
            --accent: #22d3ee;
            --gold: #fbbf24;
            --text: #f8fafc;
            --primary: #8b5cf6;
        }

        * { user-select: none; -webkit-user-select: none; box-sizing: border-box; font-family: 'Inter', sans-serif; cursor: default; }
        
        body { 
            margin: 0; background: var(--bg); color: var(--text); 
            height: 100vh; display: flex; overflow: hidden;
        }

        .hidden { display: none !important; }

        /* AUTH SCREEN */
        #screen-auth {
            position: fixed; inset: 0; z-index: 9999; background: var(--bg);
            display: flex; justify-content: center; align-items: center;
        }
        .auth-card { background: var(--panel); padding: 40px; border-radius: 24px; width: 350px; border: 1px solid #1e293b; text-align: center; }
        input { width: 100%; padding: 12px; margin: 8px 0; border-radius: 8px; border: 1px solid #334155; background: #0f172a; color: white; cursor: text; }
        .auth-btn { width: 100%; padding: 12px; margin-top: 10px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; color: white; }

        /* GAME LAYOUT */
        #screen-game {
            display: grid; grid-template-columns: 320px 1fr 320px;
            width: 100%; height: 100vh;
        }

        .side-panel {
            background: var(--panel); border-right: 1px solid #1e293b;
            display: flex; flex-direction: column; padding: 20px; overflow-y: auto;
        }
        .right-panel { border-right: none; border-left: 1px solid #1e293b; }

        /* CENTER AREA */
        .center-area {
            display: flex; flex-direction: column; align-items: center; justify-content: center;
            background: radial-gradient(circle, #1e293b 0%, #05070a 100%);
            position: relative;
        }

        #score-container { text-align: center; margin-bottom: 40px; }
        #score-val { font-size: 3.5rem; font-weight: 900; color: var(--gold); text-shadow: 0 0 20px rgba(251, 191, 36, 0.3); }
        #cps-val { color: var(--accent); font-size: 1.1rem; }

        #main-clicker {
            width: 320px; height: 320px; border-radius: 50%;
            border: 10px solid rgba(255,255,255,0.1);
            background: url('https://i.imgur.com/GscT2bX.png') center/cover;
            cursor: pointer; transition: transform 0.05s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 0 60px rgba(34, 211, 238, 0.2);
        }
        #main-clicker:active { transform: scale(0.92); }

        /* UPGRADE CARDS */
        .item-card {
            background: rgba(255,255,255,0.03); border: 1px solid #1e293b;
            padding: 12px; margin-bottom: 8px; border-radius: 12px;
            display: flex; justify-content: space-between; align-items: center;
            transition: 0.2s; cursor: pointer;
        }
        .item-card:hover { background: rgba(255,255,255,0.08); border-color: var(--accent); }
        .item-card.locked { opacity: 0.4; filter: grayscale(1); cursor: not-allowed; }
        .item-info b { display: block; font-size: 1rem; color: var(--accent); }
        .item-info span { font-size: 0.8rem; color: #94a3b8; }
        .item-cost { font-weight: bold; color: var(--gold); }

        /* LEADERBOARD */
        .lb-row { display: flex; justify-content: space-between; padding: 10px; border-radius: 8px; margin-bottom: 4px; background: rgba(0,0,0,0.2); }
        .rank-1 { background: linear-gradient(90deg, rgba(251, 191, 36, 0.2), transparent); border: 1px solid var(--gold); }

        /* FLOATING TEXT */
        .plus-one {
            position: absolute; color: white; font-weight: bold; font-size: 1.5rem;
            pointer-events: none; animation: floatUp 0.8s ease-out forwards;
        }
        @keyframes floatUp { 0% { opacity: 1; transform: translateY(0); } 100% { opacity: 0; transform: translateY(-100px); } }

        /* PRESTIGE BAR */
        .prestige-btn {
            margin-top: 30px; background: var(--primary); padding: 12px 24px;
            border-radius: 12px; border: none; color: white; font-weight: bold;
            cursor: pointer; transition: 0.3s;
        }
        .prestige-btn:disabled { background: #334155; cursor: not-allowed; }
    </style>
</head>
<body oncontextmenu="return false;">

    <div id="screen-auth">
        <div class="auth-card">
            <h1 style="color:var(--accent); margin-top:0;">VRAJ CLICKER 2</h1>
            <input type="text" id="username" placeholder="Display Username">
            <input type="email" id="email" placeholder="Email Address">
            <input type="password" id="pass" placeholder="Password">
            <button onclick="login()" class="auth-btn" style="background:var(--accent); color:#000;">LOGIN</button>
            <button onclick="signup()" class="auth-btn" style="background:var(--primary);">SIGN UP</button>
            <p id="auth-msg" style="font-size:0.8rem; color:#94a3b8; margin-top:15px;">Login to save your global rank</p>
        </div>
    </div>

    <div id="screen-game" class="hidden">
        
        <div class="side-panel">
            <h2 style="color:var(--accent); font-size:1.2rem; border-bottom:1px solid #1e293b; padding-bottom:10px;">VRAJ STORE</h2>
            <div id="store-list"></div>
        </div>

        <div class="center-area">
            <div id="score-container">
                <div id="score-val">0</div>
                <div id="cps-val">per second: 0</div>
            </div>
            
            <div id="main-clicker"></div>

            <button id="prestige-btn" class="prestige-btn" onclick="prestige()" disabled>
                PRESTIGE (Level 0)<br><small>Requires 1 Million Clicks</small>
            </button>
        </div>

        <div class="side-panel right-panel">
            <h2 style="color:var(--gold); font-size:1.2rem; border-bottom:1px solid #1e293b; padding-bottom:10px;">TOP PLAYERS</h2>
            <div id="lb-body"></div>
            
            <button onclick="logout()" style="margin-top:auto; background:transparent; border:1px solid #ef4444; color:#ef4444; padding:8px; border-radius:8px; cursor:pointer;">Logout</button>
        </div>

    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getAuth, createUserWithEmailAndPassword, signInWithEmailAndPassword, onAuthStateChanged, signOut, sendEmailVerification } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-auth.js";
        import { getDatabase, ref, set, update, onValue, query, orderByChild, limitToLast } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        const firebaseConfig = {
            apiKey: "AIzaSyDwg2ZSpQspAD-o19AZCOHcrl9VnYc_sdk",
            authDomain: "vraj-clicker-2.firebaseapp.com",
            projectId: "vraj-clicker-2",
            storageBucket: "vraj-clicker-2.firebasestorage.app",
            messagingSenderId: "162243172716",
            appId: "1:162243172716:web:874a1f8be471a9f0d83b49",
            measurementId: "G-SBJ4W7JRRL"
        };

        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);
        const db = getDatabase(app);

        let userData = { score: 0, cps: 0, prestige: 0, multiplier: 1, name: "", counts: {} };

        // --- 100 UPGRADE GENERATOR ---
        const upgradeTypes = ["Finger", "Clicker", "Bot", "Server", "AI", "Clone", "Factory", "Planet", "Galaxy", "Universe"];
        const items = [];
        for(let i=1; i<=100; i++) {
            const type = upgradeTypes[Math.floor((i-1)/10)];
            items.push({
                id: 'i'+i,
                name: `Vraj's ${type} #${i}`,
                cost: Math.floor(15 * Math.pow(1.3, i-1)),
                power: (i * 0.5) * Math.pow(1.2, i/5)
            });
        }

        // --- AUTH ---
        window.signup = () => {
            const user = document.getElementById('username').value;
            const email = document.getElementById('email').value;
            const pass = document.getElementById('pass').value;
            if(!user) return alert("Enter a username!");
            createUserWithEmailAndPassword(auth, email, pass).then(res => {
                sendEmailVerification(res.user);
                set(ref(db, 'users/' + res.user.uid), { name: user, score: 0, cps: 0, prestige: 0, multiplier: 1, counts: {} });
                alert("Verification email sent! Check your inbox.");
            }).catch(e => alert(e.message));
        };

        window.login = () => {
            signInWithEmailAndPassword(auth, document.getElementById('email').value, document.getElementById('pass').value).catch(e => alert("Login failed"));
        };

        onAuthStateChanged(auth, user => {
            if (user && user.emailVerified) {
                document.getElementById('screen-auth').classList.add('hidden');
                document.getElementById('screen-game').classList.remove('hidden');
                onValue(ref(db, 'users/' + user.uid), s => {
                    if(s.exists()) { userData = s.val(); userData.counts = userData.counts || {}; updateUI(); }
                });
            }
        });

        // --- GAMEPLAY ---
        document.getElementById('main-clicker').onclick = (e) => {
            const clickPower = (1 + (userData.cps * 0.05)) * (userData.multiplier || 1) * Math.pow(2, userData.prestige);
            userData.score += clickPower;
            spawnText(e.pageX, e.pageY, `+${Math.floor(clickPower)}`);
            save();
        };

        window.buyItem = (id) => {
            const item = items.find(i => i.id === id);
            const count = userData.counts[id] || 0;
            const currentCost = Math.floor(item.cost * Math.pow(1.15, count));
            
            if(userData.score >= currentCost) {
                userData.score -= currentCost;
                userData.counts[id] = count + 1;
                recalcCPS();
                save();
            }
        };

        function recalcCPS() {
            let total = 0;
            items.forEach(item => {
                total += (item.power * (userData.counts[item.id] || 0));
            });
            userData.cps = total;
        }

        window.prestige = () => {
            if(userData.score >= 1000000) {
                userData.prestige += 1;
                userData.score = 0;
                userData.cps = 0;
                userData.counts = {};
                save();
                alert("PRESTIGED! Your click power has doubled permanently.");
            }
        };

        function save() {
            if(auth.currentUser) update(ref(db, 'users/' + auth.currentUser.uid), userData);
        }

        function updateUI() {
            document.getElementById('score-val').innerText = Math.floor(userData.score).toLocaleString();
            document.getElementById('cps-val').innerText = `per second: ${userData.cps.toFixed(1)}`;
            
            // Prestige Check
            const pBtn = document.getElementById('prestige-btn');
            pBtn.disabled = userData.score < 1000000;
            pBtn.innerHTML = `PRESTIGE (Lvl ${userData.prestige})<br><small>${userData.score < 1000000 ? 'Need 1M Clicks' : 'READY TO ASCEND!'}</small>`;

            // Store
            const list = document.getElementById('store-list');
            list.innerHTML = "";
            items.slice(0, (Object.keys(userData.counts).length + 3)).forEach(item => {
                const count = userData.counts[item.id] || 0;
                const cost = Math.floor(item.cost * Math.pow(1.15, count));
                const isLocked = userData.score < cost && count === 0;
                
                list.innerHTML += `
                    <div class="item-card ${isLocked ? 'locked' : ''}" onclick="buyItem('${item.id}')">
                        <div class="item-info">
                            <b>${item.name}</b>
                            <span>Own: ${count} (+${item.power.toFixed(1)}/s)</span>
                        </div>
                        <div class="item-cost">${cost.toLocaleString()}</div>
                    </div>
                `;
            });
        }

        function spawnText(x, y, txt) {
            const el = document.createElement('div');
            el.className = 'plus-one';
            el.style.left = x + 'px'; el.style.top = y + 'px';
            el.innerText = txt;
            document.body.appendChild(el);
            setTimeout(() => el.remove(), 800);
        }

        // Leaderboard
        onValue(query(ref(db, 'users'), orderByChild('score'), limitToLast(10)), s => {
            const body = document.getElementById('lb-body');
            body.innerHTML = "";
            let players = [];
            s.forEach(c => players.push(c.val()));
            players.reverse().forEach((p, i) => {
                body.innerHTML += `
                    <div class="lb-row ${i==0?'rank-1':''}">
                        <span>#${i+1} ${p.name}</span>
                        <span style="color:var(--gold)">${Math.floor(p.score).toLocaleString()}</span>
                    </div>`;
            });
        });

        window.logout = () => signOut(auth).then(() => location.reload());

        setInterval(() => {
            if(auth.currentUser?.emailVerified && userData.cps > 0) {
                userData.score += (userData.cps * 0.1);
                save();
            }
        }, 100);
    </script>
</body>
</html>
